<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="7" skipped="13" tests="32" time="5.966" timestamp="2026-02-03T16:59:44.286715+00:00" hostname="agent-env-8a6d3d11-9949-4c7a-9100-39d8b014e63f"><testcase classname="tests.test_staff_module.TestStaffModuleAuth" name="test_staff_endpoints_require_auth" time="0.279" /><testcase classname="tests.test_staff_module.TestStaffModuleInitialization" name="test_initialize_staff_module" time="0.348" /><testcase classname="tests.test_staff_module.TestStaffModuleInitialization" name="test_default_permissions_created" time="0.043" /><testcase classname="tests.test_staff_module.TestStaffModuleInitialization" name="test_default_roles_created" time="0.047" /><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_list_users" time="0.308"><failure message="AssertionError: Response should contain 'pagination' key&#10;assert 'pagination' in {'limit': 20, 'page': 1, 'pages': 0, 'total': 0, ...}">tests/test_staff_module.py:191: in test_list_users
    assert "pagination" in data, "Response should contain 'pagination' key"
E   AssertionError: Response should contain 'pagination' key
E   assert 'pagination' in {'limit': 20, 'page': 1, 'pages': 0, 'total': 0, ...}</failure></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_create_user" time="0.268"><failure message="AssertionError: Create user failed: {&quot;detail&quot;:&quot;3 validation errors for StaffUser\ndepartment_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nrole_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nassigned_company_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type&quot;}&#10;assert 400 == 201&#10; +  where 400 = &lt;Response [400]&gt;.status_code">tests/test_staff_module.py:212: in test_create_user
    assert response.status_code == 201, f"Create user failed: {response.text}"
E   AssertionError: Create user failed: {"detail":"3 validation errors for StaffUser\ndepartment_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nrole_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nassigned_company_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type"}
E   assert 400 == 201
E    +  where 400 = &lt;Response [400]&gt;.status_code</failure></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_create_user_without_password_sends_invite" time="0.044"><failure message="AssertionError: Create invite user failed: {&quot;detail&quot;:&quot;3 validation errors for StaffUser\ndepartment_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nrole_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nassigned_company_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type&quot;}&#10;assert 400 == 201&#10; +  where 400 = &lt;Response [400]&gt;.status_code">tests/test_staff_module.py:237: in test_create_user_without_password_sends_invite
    assert response.status_code == 201, f"Create invite user failed: {response.text}"
E   AssertionError: Create invite user failed: {"detail":"3 validation errors for StaffUser\ndepartment_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nrole_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type\nassigned_company_ids\n  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]\n    For further information visit https://errors.pydantic.dev/2.12/v/list_type"}
E   assert 400 == 201
E    +  where 400 = &lt;Response [400]&gt;.status_code</failure></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_update_user" time="0.267"><skipped type="pytest.skip" message="No test user created">/app/backend/tests/test_staff_module.py:248: No test user created</skipped></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_get_user_by_id" time="0.000"><skipped type="pytest.skip" message="No test user created">/app/backend/tests/test_staff_module.py:271: No test user created</skipped></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_user_state_transition_activate" time="0.083"><skipped type="pytest.skip" message="Could not create test user">/app/backend/tests/test_staff_module.py:300: Could not create test user</skipped></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_user_state_transition_suspend" time="0.265"><skipped type="pytest.skip" message="Could not create test user">/app/backend/tests/test_staff_module.py:340: Could not create test user</skipped></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_user_state_transition_reactivate" time="0.271"><skipped type="pytest.skip" message="Could not create test user">/app/backend/tests/test_staff_module.py:380: Could not create test user</skipped></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_user_state_transition_archive" time="0.264"><skipped type="pytest.skip" message="Could not create test user">/app/backend/tests/test_staff_module.py:427: Could not create test user</skipped></testcase><testcase classname="tests.test_staff_module.TestStaffUsers" name="test_invalid_state_transition" time="0.268"><skipped type="pytest.skip" message="Could not create test user">/app/backend/tests/test_staff_module.py:467: Could not create test user</skipped></testcase><testcase classname="tests.test_staff_module.TestDepartments" name="test_list_departments" time="0.303" /><testcase classname="tests.test_staff_module.TestDepartments" name="test_create_department" time="0.089"><failure message="AssertionError: Create department failed: {&quot;success&quot;:true,&quot;department&quot;:{&quot;id&quot;:&quot;263f4457-6018-46dd-84c3-fc53f7122255&quot;,&quot;organization_id&quot;:&quot;112068e7-d4ec-4516-beff-8d3087c51868&quot;,&quot;name&quot;:&quot;TEST Engineering bf6d09ba&quot;,&quot;code&quot;:&quot;ENGbf6d&quot;,&quot;description&quot;:&quot;Engineering department&quot;,&quot;parent_id&quot;:null,&quot;manager_id&quot;:null,&quot;is_active&quot;:true,&quot;is_deleted&quot;:false,&quot;created_at&quot;:&quot;2026-02-03T22:29:47.658193+05:30&quot;,&quot;updated_at&quot;:&quot;2026-02-03T22:29:47.658203+05:30&quot;,&quot;created_by&quot;:&quot;13c63573-a496-4838-9dab-9f5717575536&quot;}}&#10;assert 200 == 201&#10; +  where 200 = &lt;Response [200]&gt;.status_code">tests/test_staff_module.py:565: in test_create_department
    assert response.status_code == 201, f"Create department failed: {response.text}"
E   AssertionError: Create department failed: {"success":true,"department":{"id":"263f4457-6018-46dd-84c3-fc53f7122255","organization_id":"112068e7-d4ec-4516-beff-8d3087c51868","name":"TEST Engineering bf6d09ba","code":"ENGbf6d","description":"Engineering department","parent_id":null,"manager_id":null,"is_active":true,"is_deleted":false,"created_at":"2026-02-03T22:29:47.658193+05:30","updated_at":"2026-02-03T22:29:47.658203+05:30","created_by":"13c63573-a496-4838-9dab-9f5717575536"}}
E   assert 200 == 201
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="tests.test_staff_module.TestDepartments" name="test_update_department" time="0.044"><skipped type="pytest.skip" message="No test department created">/app/backend/tests/test_staff_module.py:578: No test department created</skipped></testcase><testcase classname="tests.test_staff_module.TestDepartments" name="test_delete_department" time="0.042"><skipped type="pytest.skip" message="Could not create test department">/app/backend/tests/test_staff_module.py:613: Could not create test department</skipped></testcase><testcase classname="tests.test_staff_module.TestRoles" name="test_list_roles" time="0.313" /><testcase classname="tests.test_staff_module.TestRoles" name="test_create_role" time="0.043"><failure message="AssertionError: Create role failed: {&quot;success&quot;:true,&quot;role&quot;:{&quot;id&quot;:&quot;f763e155-468c-4984-a502-6d255892d691&quot;,&quot;organization_id&quot;:&quot;112068e7-d4ec-4516-beff-8d3087c51868&quot;,&quot;name&quot;:&quot;TEST Custom Role ea809dbd&quot;,&quot;description&quot;:&quot;Custom role for testing&quot;,&quot;permissions&quot;:[],&quot;level&quot;:75,&quot;is_system&quot;:false,&quot;is_default&quot;:false,&quot;can_be_assigned&quot;:true,&quot;is_deleted&quot;:false,&quot;created_at&quot;:&quot;2026-02-03T22:29:48.156504+05:30&quot;,&quot;updated_at&quot;:&quot;2026-02-03T22:29:48.156512+05:30&quot;,&quot;created_by&quot;:&quot;13c63573-a496-4838-9dab-9f5717575536&quot;}}&#10;assert 200 == 201&#10; +  where 200 = &lt;Response [200]&gt;.status_code">tests/test_staff_module.py:697: in test_create_role
    assert response.status_code == 201, f"Create role failed: {response.text}"
E   AssertionError: Create role failed: {"success":true,"role":{"id":"f763e155-468c-4984-a502-6d255892d691","organization_id":"112068e7-d4ec-4516-beff-8d3087c51868","name":"TEST Custom Role ea809dbd","description":"Custom role for testing","permissions":[],"level":75,"is_system":false,"is_default":false,"can_be_assigned":true,"is_deleted":false,"created_at":"2026-02-03T22:29:48.156504+05:30","updated_at":"2026-02-03T22:29:48.156512+05:30","created_by":"13c63573-a496-4838-9dab-9f5717575536"}}
E   assert 200 == 201
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="tests.test_staff_module.TestRoles" name="test_update_role" time="0.044"><skipped type="pytest.skip" message="No test role created">/app/backend/tests/test_staff_module.py:710: No test role created</skipped></testcase><testcase classname="tests.test_staff_module.TestRoles" name="test_delete_custom_role" time="0.042"><skipped type="pytest.skip" message="Could not create test role">/app/backend/tests/test_staff_module.py:747: Could not create test role</skipped></testcase><testcase classname="tests.test_staff_module.TestRoles" name="test_cannot_delete_system_role" time="0.088" /><testcase classname="tests.test_staff_module.TestPermissionMatrix" name="test_list_permissions" time="0.612" /><testcase classname="tests.test_staff_module.TestPermissionMatrix" name="test_assign_permissions_to_role" time="0.057"><skipped type="pytest.skip" message="Could not create test role">/app/backend/tests/test_staff_module.py:850: Could not create test role</skipped></testcase><testcase classname="tests.test_staff_module.TestPermissionMatrix" name="test_remove_permissions_from_role" time="0.041"><skipped type="pytest.skip" message="Could not create test role">/app/backend/tests/test_staff_module.py:912: Could not create test role</skipped></testcase><testcase classname="tests.test_staff_module.TestAuditLogs" name="test_list_audit_logs" time="0.301" /><testcase classname="tests.test_staff_module.TestAuditLogs" name="test_audit_logs_contain_user_actions" time="0.356"><failure message="AssertionError: Should have user creation audit logs&#10;assert 0 &gt; 0&#10; +  where 0 = len([])">tests/test_staff_module.py:1013: in test_audit_logs_contain_user_actions
    assert len(user_logs) &gt; 0, "Should have user creation audit logs"
E   AssertionError: Should have user creation audit logs
E   assert 0 &gt; 0
E    +  where 0 = len([])</failure></testcase><testcase classname="tests.test_staff_module.TestAuditLogs" name="test_audit_logs_filter_by_entity_type" time="0.051" /><testcase classname="tests.test_staff_module.TestUserFilters" name="test_filter_users_by_state" time="0.350" /><testcase classname="tests.test_staff_module.TestUserFilters" name="test_search_users" time="0.051" /><testcase classname="tests.test_staff_module.TestUserFilters" name="test_pagination" time="0.050"><failure message="AssertionError: assert 'pagination' in {'limit': 5, 'page': 1, 'pages': 0, 'total': 0, ...}">tests/test_staff_module.py:1102: in test_pagination
    assert "pagination" in data
E   AssertionError: assert 'pagination' in {'limit': 5, 'page': 1, 'pages': 0, 'total': 0, ...}</failure></testcase></testsuite></testsuites>